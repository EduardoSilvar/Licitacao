<ui:composition 
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns="http://www.w3.org/1999/xhtml">
    <p:tabView id="tabview" dynamic="true">
        <p:tab title="Dados gerais">
            <h:panelGroup id="contratoPanelGroup">

                <div class="row">
                    <!--                    <div class="col-md-6">
                                            <div class="form-group">
                                                <p:outputLabel value="Nome"
                                                               for="nomeContrato" />
                                                <p:inputText id="nomeContrato"
                                                             placeholder="Nome"
                                                             rendered="true"
                                                             disabled="{managerContrato.visualizar}"
                                                             value="{managerContrato.contrato.nome}"
                                                             requiredMessage="Este campo é obrigatório."
                                                             styleClass="form-control" 
                                                             />
                                                <p:message for="nomeContrato" />
                                            </div>
                                        </div>-->
                    <div class="col-md-6">
                        <div class="form-group">
                            <p:outputLabel value="N° do processo"
                                           for="numeroProcesso" />
                            <p:inputText id="numeroProcesso"
                                         placeholder="N° do processo"
                                         rendered="true"
                                         required="true"
                                         disabled="#{managerContrato.visualizar}"
                                         requiredMessage="Este campo é obrigatório."
                                         styleClass="form-control" 
                                         value="#{managerContrato.contrato.numeroProcesso}"
                                         />
                            <p:message for="numeroProcesso" />
                        </div>
                    </div>


                    <div class="col-md-6">
                        <div class="form-group" >
                            <p:outputLabel value="Contratado" styleClass="control-label" for="contratadoSelect" />
                            <p:inputText id="contratadoSelect"
                                         value="#{managerContrato.contrato.contratado}"
                                         placeholder="Contratado"
                                         title="Clique para adicionar o contratado"
                                         readonly="true"
                                         styleClass="form-control"
                                         onclick="PF('pesquisarContratadoDialog').show();"
                                         disabled="#{managerContrato.visualizar}" />
                            <!--                            <p:selectOneMenu id="contratadoSelect"
                                                                         value="{managerContrato.contrato.contratado}"
                                                                         filter="true" 
                                                                         placeholder="Contratado"
                                                                         styleClass="form-control" 
                                                                         required="true"
                                                                         disabled="{managerContrato.visualizar}"
                                                                         converter="contratadoconverter" >
                                                            <f:selectItem  itemLabel="Selecione..." noSelectionOption="true" />
                                                            <f:selectItems value="{managerContrato.contratados}" var="contratado" itemLabel="{contratado.nome}" itemValue="{contratado}"/>
                                                        </p:selectOneMenu>-->
                        </div> 
                    </div>
                </div>
                <!--                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <p:outputLabel value="Número"
                                                           for="numeroContrato" />
                                            <p:inputMask id="numeroContrato"
                                                         placeholder=""
                                                         rendered="true"
                                                         disabled="{managerContrato.visualizar}"
                                                         required="true"
                                                         requiredMessage="Este campo é obrigatório."
                                                         styleClass="form-control" 
                                                         value="{managerContrato.contrato.numeroContrato}"
                                                         />
                                            <p:message for="numeroContrato" />
                                        </div> 
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <p:outputLabel value="N° da licitação"
                                                           for="numeroLicitacao" />
                                            <p:inputText id="numeroLicitacao"
                                                         placeholder="N° da licitação"
                                                         rendered="true"
                                                         required="true"
                                                         disabled="{managerContrato.visualizar}"
                                                         requiredMessage="Este campo é obrigatório."
                                                         styleClass="form-control" 
                                                         value="{managerContrato.contrato.numeroLicitacao}"
                                                         />
                                            <p:message for="numeroLicitacao" />
                                        </div>
                                    </div>
                
                                </div>-->

                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <p:outputLabel value="Objeto do contrato"
                                           for="objetoContrato" />
                            <p:inputTextarea id="objetoContrato"
                                             required="true"
                                             styleClass="form-control" 
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.objetoContrato}"
                                             requiredMessage="Este campo é obrigatório." />
                            <p:message for="objetoContrato" />
                        </div> 
                    </div>
                </div>

                <!-- linha 2 -->
                <div class="row">
                    <div class="col-md-5">
                        <div class="form-group">
                            <p:outputLabel value="Tipo de contrato" styleClass="control-label" for="tipoContratoSelect" />
                            <p:selectOneMenu id="tipoContratoSelect"
                                             filter="true" 
                                             placeholder="Tipo"
                                             styleClass="form-control" 
                                             required="true"
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.tipoContrato}">
                                <f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
                                <f:selectItems value="#{managerEnuns.tipoContrato}" var="tipoContrato" itemLabel="#{tipoContrato.label}" itemValue="#{tipoContrato}"/>
                            </p:selectOneMenu> 
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <p:outputLabel value="Tipo de licitação" styleClass="control-label" for="tipoLicitacaoSelect" />
                            <p:selectOneMenu id="tipoLicitacaoSelect"
                                             filter="true" 
                                             placeholder="Tipo"
                                             styleClass="form-control"
                                             value="#{managerContrato.contrato.tipoLicitacao}"
                                             required="true"
                                             disabled="#{managerContrato.visualizar}"
                                             >
                                <f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
                                <f:selectItems value="#{managerEnuns.tipoLicitacao}" var="tipoLicitacao" itemLabel="#{tipoLicitacao.label}" itemValue="#{tipoLicitacao}" />
                            </p:selectOneMenu>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group" style="display: flex;flex-direction: column" >
                            <p:outputLabel value="Valor"
                                           for="valor" />

                            <p:inputNumber id="valor"   value="#{managerContrato.contrato.valor}" symbol="R$"
                                           symbolPosition="p" emptyValue="always" requiredMessage="Este campo é obrigatório."
                                           disabled="#{managerContrato.visualizar}" />
                            <p:message for="valor" />
                        </div>
                    </div>
                </div>
                <div class="row">

                    <!--                    <div class="col-md-3">
                                            <div class="form-group">
                                                <p:outputLabel value="Possui tempo determinado ?"/>
                                                <div class="ui-inputgroup">
                                                    <p:selectBooleanButton id="tempoDeterminadoButton"   disabled="{managerContrato.visualizar}" value="{managerContrato.contrato.possuiTempoDeterminado}" onLabel="Sim" offLabel="Não" style="width:12rem; color: white !important;border-radius: 5px">
                                                        <p:ajax update="dataDefinida"/>
                                                    </p:selectBooleanButton>
                                                </div>
                                            </div>
                                        </div>-->
                    <div class="col-md-12">
                        <div class="row">
                            <div  style="width: 45%;margin-right: 30px;margin-left: 15px">
                                <p:outputLabel value="Data inicial"
                                               for="dataInicialContrato" />
                                <p:calendar id="dataInicialContrato"
                                            rendered="true"
                                            required="true"
                                            disabled="#{managerContrato.visualizar}"
                                            mask="true"
                                            style="display: flex; flex-direction: row"
                                            requiredMessage="Este campo é obrigatório."
                                            inputStyleClass="form-control"
                                            value="#{managerContrato.contrato.dataInicio}"
                                            showOn="button"
                                            >
                                    <p:ajax event="dateSelect" update="dataFinalContrato"/>
                                </p:calendar>
                                <p:message for="dataInicialContrato" />
                            </div>
                            <div  style="width: 45%">
                                <p:outputLabel value="Data final"
                                               for="dataFinalContrato" />
                                <p:calendar id="dataFinalContrato"
                                            rendered="true"
                                            required="true"
                                            mask="true"
                                            mindate="#{managerContrato.contrato.dataInicio}"
                                            disabled="#{managerContrato.visualizar}"
                                            style="display: flex; flex-direction: row"
                                            requiredMessage="Este campo é obrigatório."
                                            inputStyleClass="form-control"
                                            value="#{managerContrato.contrato.dataFinal}"
                                            showOn="button"
                                            >
                                    <p:ajax listener="#{managerContrato.verificarData()}" event="blur" process="@this" update="corpoInteiro:messages" />
                                </p:calendar>
                                <p:message for="dataFinalContrato" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <p:outputLabel value="Tipo de fiscalização" styleClass="control-label" for="tipoFiscalizacaoSelect" />
                        <p:selectOneMenu id="tipoFiscalizacaoSelect"
                                         filter="true" 
                                         style="margin-bottom: 10%"
                                         placeholder="Tipo fiscalização"
                                         required="true"
                                         styleClass="form-control"
                                         disabled="#{managerContrato.visualizar}"
                                         requiredMessage="Este campo é obrigatório."
                                         value="#{managerContrato.contrato.tipoFiscalizacao}"
                                         >
                            <f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
                            <f:selectItems value="#{managerEnuns.tipoFiscalizacao}" var="tipo" itemLabel="#{tipo.label}" itemValue="#{tipo}" >
                            </f:selectItems>
                            <p:ajax update="tipoFiscalPanelGroup tipoFiscalButton tipoFiscalDataTable" process="tipoFiscalizacaoSelect" listener="#{managerContrato.verificarTipoFiscal()}"/>
                        </p:selectOneMenu>
                    </div>
                    <h:panelGroup  id="tipoFiscalPanelGroup">
                        <h:panelGroup rendered="#{managerContrato.renderedFiscalIndividual}" >
                            <div style="width: 160%;margin-left: 5%">
                                <div class="form-group">
                                    <p:outputLabel value="Fiscal de contrato" styleClass="control-label" for="fiscalIndividualSelect" />
                                    <p:selectOneMenu id="fiscalIndividualSelect"
                                                     filter="true" 
                                                     placeholder="fiscal"
                                                     required="true"
                                                     styleClass="form-control"
                                                     disabled="#{managerContrato.visualizar}"
                                                     requiredMessage="Este campo é obrigatório."
                                                     converter="usuarioconverter"
                                                     value="#{managerContrato.contrato.fiscal}"
                                                     >
                                        <f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
                                        <f:selectItems value="#{managerContrato.responsaveis}" var="user" itemLabel="#{user.nome}" itemValue="#{user}" />
                                    </p:selectOneMenu>
                                </div>
                            </div>
                        </h:panelGroup>

                        <h:panelGroup id="tipoFiscalButton">
                            <div style="width: 160%;margin-left: 5%;margin-top: 15%">
                                <div class="form-group"> 
                                    <p:commandButton  style="width: 200px"  disabled="#{managerContrato.visualizar}" oncomplete="PF('pesquisarFiscalDialog').show();" rendered="#{managerContrato.renderedFiscalComissao}"  value="Adicionar Fiscal"/>
                                </div>
                            </div>
                        </h:panelGroup>
                    </h:panelGroup>
                </div>
                <h:panelGroup  id="tipoFiscalDataTable">

                    <h:panelGroup id="fiscalDatatable" rendered="#{managerContrato.renderedFiscalComissao}" >
                        <p:dataTable id="contratoDatatable" var="fiscal" value="#{managerContrato.contrato.fiscaisContrato}"
                                     resizeMode="5" rowsPerPageTemplate="5, 10, 20"  paginator="true" style="margin-bottom: 7%"
                                     rows="5" paginatorPosition="bottom"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                                     emptyMessage="Nenhum fiscal adicionado...">
                            <f:facet name="header">
                                <center>
                                    Fiscais
                                </center>
                            </f:facet>
                            <p:column headerText="Ações" width="15%">
                                <p:commandButton icon="pi pi-trash"
                                                 title="Remover Relatório"
                                                 process="@this"
                                                 disabled="#{managerContrato.visualizar}"
                                                 update="corpoInteiro:tabview:removerFiscalConfirmDialog"
                                                 oncomplete="PF('removerFiscalConfirmDialog').show();"
                                                 styleClass="ml-md-1">
                                    <f:setPropertyActionListener value="#{fiscal}"
                                                                 target="#{managerContrato.fiscal}"/>
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="Nome">
                                <h:outputText value="#{fiscal.nome}" />
                            </p:column>
                            <p:column headerText="E-mail">
                                <h:outputText value="#{fiscal.email}" />
                            </p:column>
                            <p:column headerText="Setor">
                                <h:outputText value="#{fiscal.setor.nome}" />
                            </p:column>
                            <p:column headerText="Vigência">
                                <h:outputText value="#{fiscal.telefone}"  />
                            </p:column>
                        </p:dataTable>
                        <!--                                                                <div class="row">
                                                                                            <div class="col-md-6" >
                                                                                                <p:outputLabel value="Fiscal de contrato" styleClass="control-label" for="fiscalComissaoSelect" />
                                                                                                <p:selectManyMenu id="fiscalComissaoSelect"
                                                                                                                  value="{managerContrato.contrato.fiscalContrato}"
                                                                                                                  filter="true"
                                                                                                                  var="c"
                                                                                                                  required="true"
                                                                                                                  showCheckbox="true" 
                                                                                                                  converter="usuarioconverter"
                                                                                                                  styleClass="manymenu-advanced">
                                                                                                    <f:selectItems value="{managerContrato.responsaveis}" var="user" itemLabel="{user.nome}"
                                                                                                                   itemValue="{user}"/>
                                                                
                                                                                                    <p:column>
                                                                                                        <h:outputText value="{c.nome}"/>
                                                                                                    </p:column>
                                                                                                </p:selectManyMenu>
                                                                                            </div>
                                                                                        </div>
                                                            </h:panelGroup>-->
                    </h:panelGroup>
                </h:panelGroup>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <p:outputLabel value="Setor reponsável" styleClass="control-label" for="setorSelect" />
                            <p:selectOneMenu id="setorSelect"
                                             filter="true" 
                                             required="true"
                                             styleClass="form-control"
                                             disabled="#{managerContrato.visualizar}"
                                             requiredMessage="Este campo é obrigatório."
                                             converter="setorconverter"
                                             value="#{managerContrato.contrato.setor}"
                                             >
                                <f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
                                <f:selectItems value="#{managerContrato.setores}" var="setor" itemLabel="#{setor.nome}" itemValue="#{setor}" />
                            </p:selectOneMenu>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <p:outputLabel value="Status do contrato" styleClass="control-label" for="statusContratoSelect" />
                            <p:selectOneMenu id="statusContratoSelect"
                                             filter="true" 
                                             placeholder="status"
                                             required="true"
                                             disabled="#{managerContrato.visualizar}"
                                             styleClass="form-control" 
                                             value="#{managerContrato.contrato.status}">
                                <f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
                                <f:selectItems value="#{managerEnuns.statusContrato}" var="status" itemLabel="#{status.label}" itemValue="#{status}" />
                            </p:selectOneMenu>
                        </div>
                    </div>

                    <!--                    <div class="col-md-6">
                                            <div class="form-group">
                                                <p:outputLabel value="Descrição"
                                                               for="descricaoContrato" />
                                                <p:inputTextarea id="descricaoContrato"
                                                                 placeholder="Descrição"
                                                                 rendered="true"
                                                                 disabled="{managerContrato.visualizar}"
                                                                 value="{managerContrato.contrato.descricao}"
                                                                 requiredMessage="Este campo é obrigatório."
                                                                 styleClass="form-control" 
                                                                 />
                                                <p:message for="descricaoContrato" />
                                            </div>
                                        </div>-->

                </div>
                <h:panelGroup id="dadosBancariosPanelGroup">
                    <h4>Dados bancários</h4>
                    <hr></hr>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <p:outputLabel value="Banco"
                                               for="bancoContrato" />
                                <p:inputText id="bancoContrato"
                                             placeholder=""
                                             rendered="true"
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.banco}"
                                             requiredMessage="Este campo é obrigatório."
                                             styleClass="form-control" 
                                             />
                                <p:message for="bancoContrato" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <p:outputLabel value="N° da conta"
                                               for="contaContrato" />
                                <p:inputMask id="contaContrato"
                                             style="display: flex; flex-direction: row"
                                             styleClass="form-control" 
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.numeroConta}"
                                             requiredMessage="Este campo é obrigatório." />
                                <p:message for="contaContrato" />
                            </div> 
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <p:outputLabel value="Dígito"
                                               for="digitoContaContrato" />
                                <p:inputMask id="digitoContaContrato"
                                             style="display: flex; flex-direction: row"
                                             styleClass="form-control"
                                             placeholder=""
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.digito}"
                                             requiredMessage="Este campo é obrigatório." />
                                <p:message for="digitoContaContrato" />
                            </div> 
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <p:outputLabel value="Agência"
                                               for="agenciaContrato" />
                                <p:inputText id="agenciaContrato"
                                             placeholder=""
                                             rendered="true"
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.agencia}"
                                             requiredMessage="Este campo é obrigatório."
                                             styleClass="form-control" 
                                             />
                                <p:message for="agenciaContrato" />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <p:outputLabel value="Operação"
                                               for="operacaoContrato" />
                                <p:inputMask id="operacaoContrato"
                                             style="display: flex; flex-direction: row"
                                             styleClass="form-control" 
                                             placeholder=""
                                             disabled="#{managerContrato.visualizar}"
                                             value="#{managerContrato.contrato.operacao}"
                                             requiredMessage="Este campo é obrigatório." />
                                <p:message for="operacaoContrato" />
                            </div> 
                        </div>
                        <div class="col-md-3">
                            <div class="form-group" style="display: flex;flex-direction: column" >
                                <p:outputLabel value="Saldo inicial"
                                               for="saldoContaContrato" />

                                <p:inputNumber id="saldoContaContrato" style="width: 30%"  value="#{managerContrato.contrato.saldoInicial}" symbol="R$"
                                               symbolPosition="p" emptyValue="always" requiredMessage="Este campo é obrigatório."
                                               disabled="#{managerContrato.visualizar}" />
                                <p:message for="saldoContaContrato" />

                                <!--                            <p:inputText id="saldoContaContrato"
                                                                         style="display: flex; flex-direction: row"
                                                                         styleClass="form-control" 
                                                                         disabled="{managerContrato.visualizar}"
                                                                         onkeypress="jQuery(this).autoNumeric({aSign: 'R$ ', aSep: '.', aDec: ','});"
                                                                         value="{managerContrato.contrato.saldoInicial}"
                                                                         requiredMessage="Este campo é obrigatório." />
                                                            <p:message for="saldoContaContrato" />-->
                            </div> 
                        </div>
                    </div>
                </h:panelGroup>
                <h:panelGroup id="anexoProtocoloPanelGroup">
                    <p:fileUpload
                        required="true"
                        requiredMessage="Os Documentos de Anexo devem ser enviados"
                        auto="true"
                        mode="advanced"
                        label="Anexar"
                        listener="#{ managerContrato.selecionarAnexo }"
                        uploadLabel="Enviar"
                        cancelLabel="Cancelar"
                        multiple="true"
                        allowTypes="/(\.|\/)(jpe?g|png|doc|docx|pdf|odt|tiff|tif)$/"
                        dragDropSupport="true"
                        invalidFileMessage="Tipo de arquivo não suportado."
                        invalidSizeMessage="Tamanho do arquivo não é suportado"
                        process="@this @form"
                        update="@this, anexoProtocoloPanelGroup anexosPanelGroup" 
                        rendered="#{not managerContrato.visualizar}"/>
                </h:panelGroup>
                <h:panelGroup id="anexosPanelGroup">
                    <div style="display: flex; flex-direction: row">
                        <ui:repeat value="#{managerContrato.contrato.anexos}" var="anexo" >
                            <div style="display: flex; flex-direction: row">
                                <div style="display: flex; flex-direction: column;background: #e1e6e5;width: 200px; padding: 5px 10px; margin: 10px 30px ">
                                    <div style="display: flex; flex-direction: row;width: 200px">
                                        <p:commandButton style="width: 25px; height: 30px;" icon="pi pi-eye" rendered="#{managerContrato.isPDF(anexo)}" onclick="target = '_blank'" ajax="false"  actionListener="#{managerContrato.visualizarAnexo(anexo)}"/>

                                        <h:panelGroup rendered="#{!managerContrato.isPDF(anexo)}">
                                            <a href="#{managerContrato.anexoUrl(anexo)}" target="_blank">
                                                <i  style="border-radius: 3px;border: 1px solid #08c1cf ; width: 25px;justify-content: center;padding-top: 7px;color: #ffffff;text-align: center; height: 30px;background: #01415B !important" class="pi pi-eye"></i>
                                            </a> 
                                        </h:panelGroup>
                                        <p:commandButton actionListener="#{managerContrato.deletarAnexo(anexo)}" 
                                                         update="corpoInteiro:messages corpoInteiro" disabled="#{managerContrato.visualizar}" icon="pi pi-trash" style="width: 25px; height: 30px;" />
                                        <p:outputLabel value="Contrato" style="font-weight: bold;margin-left: 10px;"/>
                                    </div>
                                    <img  src="#{managerContrato.anexoUrl(anexo)}" style="width: 180px;height: 180px" />
                                </div>
                            </div>
                        </ui:repeat>
                    </div>
                </h:panelGroup>
            </h:panelGroup>

            <center>
                <p:button value="Editar" id="editarButton" icon="pi pi-pencil"  rendered="#{managerContrato.visualizar}" href="contrato.xhtml?editar=#{managerContrato.contrato.id}" />
                <p:commandButton value="atualizar" id="atualizarButton" icon="pi pi-refresh" rendered="#{managerContrato.editar}" process="@this contratoPanelGroup" update="corpoInteiro" actionListener="#{managerContrato.atualizar()}" style="margin: 0px 20px; background-color: #01415B; color: #fff; margin-bottom: 10px;"/>
                <p:commandButton value="salvar" id="cadastrarButton" icon="pi pi-save" rendered="#{managerContrato.cadastrar}" process="@this contratoPanelGroup" update="corpoInteiro" actionListener="#{managerContrato.salvar()}" style="margin: 0px 20px; background-color: #01415B; color: #fff; margin-bottom: 10px;"/>
                <p:button value="cancelar" icon="pi pi-ban" href="index.xhtml"  style="background-color: #01415B; color: #fff;margin-bottom: 10px"/>
            </center>

        </p:tab>
        <p:tab title="Acréscimos" rendered="#{managerContrato.visualizar}">
            <ui:include src="pesquisaAcrescimo.xhtml"/>
        </p:tab>
        <p:tab title="Supressões" rendered="#{managerContrato.visualizar}">
            <ui:include src="pesquisaSupressao.xhtml"/>
        </p:tab>
        <p:tab title="Renovações" rendered="#{managerContrato.visualizar}">
            <ui:include src="pesquisaRenovacao.xhtml"/>
        </p:tab>
        <p:tab title="Reajuste" rendered="#{managerContrato.visualizar}">
            <ui:include src="pesquisaRepactuacao.xhtml"/>
        </p:tab>
        <p:tab title="Mensagens" rendered="#{managerContrato.mensagensEmail.size() > 0}" >
            <ui:include src="mensagemForm.xhtml"/>
        </p:tab>
    </p:tabView>
    <p:dialog id="removeraContratoConfirmDialog"
              widgetVar="removeraContratoConfirmDialog"
              header="Atenção!"
              closeOnEscape="true"
              draggable="false"
              maximizable="false"
              minimizable="false"
              modal="true"
              width="850"
              showEffect="fade"
              hideEffect="fade">

        <div class="row">

            <div class="col-md-12">
                <div class="form-group" style="padding-left: 80px !important">
                    <h4>
                        <i class="pi pi-exclamation-triangle"></i>
                        Tem certeza de que deseja remover este Contratado ?
                    </h4>
                </div>
            </div>

            <div class="col-md-12">

                <center>

                    <p:commandButton value="Sim"
                                     title="Confirmar Remoção"
                                     icon="pi pi-check"
                                     update="corpoInteiro "
                                     process="@this"
                                     actionListener="#{managerContrato.deletar()}"
                                     oncomplete="PF('removeraContratoConfirmDialog').hide();"
                                     styleClass="mr-md-1"/>

                    <p:commandButton value="Não"
                                     title="Cancelar Remoção"
                                     icon="pi pi-ban"
                                     process="@this"
                                     update="@form"
                                     oncomplete="PF('removeraContratadoConfirmDialog').hide();"
                                     styleClass="ml-md-1"/>

                </center>

            </div>

        </div>


    </p:dialog>

    <p:dialog id="mensagemcontratadoDialog"
              widgetVar="mensagemcontratadoDialog"
              header="Atenção!"
              closeOnEscape="true"
              draggable="false"
              maximizable="false"
              minimizable="false"
              modal="true"
              width="850"
              showEffect="fade"
              hideEffect="fade">

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <p:outputLabel value="Assunto"
                                   for="Assunto" />
                    <p:inputText id="Assunto"
                                 placeholder="Texto"
                                 rendered="true"
                                 value="#{managerContrato.assunto}"
                                 requiredMessage="Este campo é obrigatório."
                                 styleClass="form-control" 
                                 />
                    <p:message for="Assunto" />
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <p:outputLabel value="Mensagem"
                                   for="Mensagem" />
                    <p:inputTextarea id="Mensagem"
                                     placeholder="Texto"
                                     rendered="true"
                                     value="#{managerContrato.textoMensagem}"
                                     requiredMessage="Este campo é obrigatório."
                                     styleClass="form-control" 
                                     />
                    <p:message for="Mensagem" />
                </div>
            </div>

            <div class="col-md-12">

                <center>

                    <p:commandButton value="Enviar"
                                     title="Enviar"
                                     icon="pi pi-upload"
                                     update="corpoInteiro @form"
                                     process="@this Mensagem Assunto"
                                     actionListener="#{managerContrato.enviarEmail()}"
                                     oncomplete="PF('mensagemcontratadoDialog').hide();"
                                     styleClass="mr-md-1"/>

                    <p:commandButton value="Cancelar"
                                     title="Cancelar Mensagem"
                                     icon="pi pi-ban"
                                     process="@this"
                                     update="@form"
                                     oncomplete="PF('mensagemcontratadoDialog').hide();"
                                     styleClass="ml-md-1"/>

                </center>

            </div>

        </div>


    </p:dialog>


    <p:dialog id="removerFiscalConfirmDialog"
              widgetVar="removerFiscalConfirmDialog"
              header="Atenção!"
              closeOnEscape="true"
              draggable="false"
              maximizable="false"
              minimizable="false"
              modal="true"
              showEffect="fade"
              hideEffect="fade">   
        <div class="row">

            <div class="col-md-12">
                <div class="form-group">
                    <h4>
                        <i class="pi pi-exclamation-triangle"></i>
                        Tem certeza de que deseja remover este Fiscal ?
                    </h4>
                </div>
            </div>

            <div class="col-md-12">

                <center>

                    <p:commandButton value="Sim"
                                     title="Confirmar Remoção"
                                     icon="pi pi-check"
                                     actionListener="#{managerContrato.removerFiscal()}"
                                     process="@this"
                                     update="corpoInteiro:tabview:fiscalDatatable"
                                     oncomplete="PF('removerFiscalConfirmDialog').hide();"
                                     styleClass="mr-md-1"/>

                    <p:commandButton value="Não"
                                     title="Cancelar Remoção"
                                     icon="pi pi-close"
                                     process="@this"
                                     update="corpoInteiro:tabview:fiscalDatatable"
                                     oncomplete="PF('removerFiscalConfirmDialog').hide();"
                                     styleClass="ml-md-1"/>

                </center>

            </div>

        </div>

    </p:dialog>

    <p:dialog id="pesquisarFiscalDialog"
              widgetVar="pesquisarFiscalDialog"
              header="Pesquisar Fiscal"
              closeOnEscape="true"
              draggable="false"
              height="400"
              width="1000"
              maximizable="false"
              minimizable="false"
              modal="true"
              showEffect="fade"
              hideEffect="fade">   
        <div class="row">

            <div class="col-md-12">
                <div class="form-group">

                    <p:dataTable id="PesquisacontratoDatatable" var="fiscal" value="#{managerContrato.responsaveis}"
                                 rowsPerPageTemplate="5, 10, 20"  paginator="true" style="margin-bottom: 7%"
                                 rows="5" paginatorPosition="bottom"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                                 emptyMessage="Nenhum relatorio encontrado...">
                        <f:facet name="header">
                            <center>
                                Fiscais
                            </center>
                        </f:facet>
                        <p:column headerText="Ações" width="15%">
                            <p:commandButton icon="pi pi-plus"
                                             title="Remover Relatório"
                                             process="@this"
                                             actionListener="#{managerContrato.adicionarFiscal(fiscal)}"
                                             update="@this corpoInteiro:messages corpoInteiro:tabview:fiscalDatatable"
                                             oncomplete="PF('pesquisarFiscalDialog').hide();"
                                             styleClass="ml-md-1">
                            </p:commandButton>
                        </p:column>
                        <p:column headerText="Nome">
                            <h:outputText value="#{fiscal.nome}" />
                        </p:column>
                        <p:column headerText="E-mail">
                            <h:outputText value="#{fiscal.email}" />
                        </p:column>
                        <p:column headerText="Setor">
                            <h:outputText value="#{fiscal.setor.nome}" />
                        </p:column>
                        <p:column headerText="Vigência">
                            <h:outputText value="#{fiscal.telefone}"  />
                        </p:column>
                    </p:dataTable>

                </div>
            </div>
        </div>
    </p:dialog>
    <p:dialog id="pesquisarContratadoDialog"
              widgetVar="pesquisarContratadoDialog"
              closeOnEscape="true"
              draggable="false"
              maximizable="false"
              minimizable="false"
              showEffect="fade"
              hideEffect="fade"
              width="1200"
              height="500">

        <h4>
            <i class="fa fa-search"></i>
            Pesquisar Contratado
        </h4>
        <hr/>
        <h:panelGroup id="selectorPanelGroup"  >


            <p:selectOneRadio id="console" value="#{managerContrato.contratado.natureza}"  unselectable="true"  style="margin: 10px">
                <f:selectItem itemLabel="Jurídica" itemValue="#{managerContrato.juridica}" />
                <f:selectItem itemLabel="Fisica" itemValue="#{managerContrato.fisica}"/>
                <p:ajax update="corpoInteiro:dadosContratado"  />
            </p:selectOneRadio>
        </h:panelGroup>
        <h:panelGroup id="dadosContratado">

            <div class="row">
                <h:panelGroup rendered="#{managerContrato.renderedCnpjPEssoa()}">
                    <div class="col-md-3">
                        <div class="form-group">
                            <p:outputLabel value="CNPJ"
                                           for="cnpjPessoaJuriInput"  />
                            <p:inputMask id="cnpjPessoaJuriInput"
                                         placeholder="CNPJ"
                                         mask="99.999.999/9999-99"
                                         value="#{managerContrato.contratado.cnpj}"
                                         requiredMessage="Este campo é obrigatório."
                                         styleClass="form-control" 
                                         >
                            </p:inputMask>
                            <p:message for="cnpjPessoaJuriInput" />
                        </div>
                    </div>
                </h:panelGroup>
                <h:panelGroup rendered="#{managerContrato.renderedCpfPEssoa()}">
                    <div class="col-md-3">
                        <div class="form-group">
                            <p:outputLabel value="CPF"
                                           for="cpfConjugeInputMaskPesquisarConjugeDialog" />
                            <p:inputMask id="cpfConjugeInputMaskPesquisarConjugeDialog"
                                         value="#{managerContrato.contratado.cpf}"
                                         placeholder="CPF"
                                         mask="999.999.999-99"
                                         styleClass="form-control" />
                        </div>
                    </div>
                </h:panelGroup>
                <div class="col-md-9">
                    <div class="form-group">
                        <p:outputLabel value="Nome"
                                       for="nomeContratadoDialog" />
                        <p:inputText id="nomeContratadoDialog"
                                     value="#{managerContrato.contratado.nome}"
                                     placeholder="Nome"
                                     styleClass="form-control" />
                    </div>
                </div>

            </div>

            <div class="row">

                <div class="col-md-12">

                    <center>
                        <p:commandButton value="Pesquisar"
                                         id="pesquisarContratadoButton"
                                         title="Pesquisar Cônjuge"
                                         icon="pi pi-search"
                                         process="dadosContratado"
                                         update=" corpoInteiro:conjugesDataTable corpoInteiro:messages"
                                         actionListener="#{managerContrato.pesquisarContratados()}"
                                         styleClass="ml-md-1"
                                         style="width: 130px;"/>

                        <p:commandButton value="Limpar"
                                         title="Limpar Pesquisa"
                                         icon="pi pi-eraser"
                                         process="@this"
                                         update="dadosContratado selectorPanelGroup"
                                         actionListener="#{managerContrato.instanciarPesquisaContratados()}"
                                         styleClass="mr-md-1"
                                         style="width: 130px;"/>


                    </center>

                </div>

            </div>

            <p:dataTable id="conjugesDataTable"
                         value="#{managerContrato.contratados}"
                         var="contratado"
                         paginator="true"
                         rows="5"
                         paginatorPosition="bottom"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                         rowsPerPageTemplate="5, 10, 20"
                         emptyMessage="Nenhum registro encontrado..."
                         styleClass="my-md-3"
                         >

                <f:facet name="header">
                    <center>
                        contratados(#{managerContrato.contratados.size()})
                    </center>
                </f:facet>

                <p:column headerText="" width="10%">

                    <p:commandButton icon="pi pi-check"
                                     title="Selecionar"
                                     process="@this"
                                     update="corpoInteiro:conjugesDataTable corpoInteiro:messages corpoInteiro:tabview:contratadoSelect corpoInteiro:tabview:dadosBancariosPanelGroup"
                                     actionListener="#{managerContrato.adicionarContratado(contratado)}"
                                     oncomplete="PF('pesquisarContratadoDialog').hide();">
                    </p:commandButton>

                </p:column>

                <p:column headerText="Nome" >
                    <p:outputLabel value="#{contratado.nome}" />
                </p:column>
                <p:column headerText="Documento">
                    <p:outputLabel value="#{contratado.cnpj != '' ?contratado.cnpj:contratado.cpf }" />
                </p:column>

            </p:dataTable>

        </h:panelGroup>

    </p:dialog>
    <script src="WEB-INF/template/autoNumeric.js" type="text/javascript"></script>
    <script>
                                            var buttonClicked = false;

                                            document.addEventListener("keydown", function (event) {
                                                if (!buttonClicked) {
                                                    if (event.keyCode === 13) { // 13 é o código da tecla Enter
                                                        var form = document.getElementById("corpoInteiro");
                                                        var button;
                                                        if (document.getElementById("cadastrarButton").style.display !== "none") {
                                                            button = document.getElementById("cadastrarButton");
                                                        } else if (document.getElementById("editarButton").style.display !== "none") {
                                                            button = document.getElementById("editarButton");
                                                        } else if (document.getElementById("atualizarButton").style.display !== "none") {
                                                            button = document.getElementById("atualizarButton");
                                                        }
                                                    }
                                                }
                                                if (document.getElementById("pesquisarContratadoDialog").visible) {
                                                    button = document.getElementById("pesquisarContratadoButton");
                                                }
                                                button.click();
                                                buttonClicked = true;
                                                event.preventDefault();
                                            });
    </script>
</ui:composition>